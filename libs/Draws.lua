local Draws = {}
local time = 0

local function convertColor(color)
    return color[1] / 255, color[2] / 255, color[3] / 255
end
local spiderSprite = {
    { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0 },
    { 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1 },
    { 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0 },
    { 0, 1, 1, 1, 1, 2, 2, 2, 2, 2, 1, 1, 1, 1, 0 },
    { 1, 0, 0, 0, 1, 2, 3, 2, 3, 2, 1, 0, 0, 0, 1 },
    { 0, 0, 1, 1, 1, 2, 2, 2, 2, 2, 1, 1, 1, 0, 0 },
    { 0, 1, 0, 0, 1, 2, 2, 2, 2, 2, 1, 0, 0, 1, 0 },
    { 1, 0, 0, 1, 0, 0, 2, 0, 2, 0, 0, 1, 0, 0, 1 },
    { 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0 },
    { 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0 },
    { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
}
local miniUltimaSprite = {
    { 0, 4, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 4, 0, 0, 4, 0, 4, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 4, 0, 0, 4, 4, 0, 4, 4, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 0, 4, 0, 4, 0, 0, 4, 0, 0, 4, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 4, 0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0, 4, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 4, 0, 0, 4, 0, 0, 4, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 4, 0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 0, 0, 4, 0, 0, 4, 0, 0, 4, 0, 0, 0, 4, 0, 0, 0, 0, 4, 0, 0, 4, 4, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 4, 0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 4, 0, 0, 0, 4, 0, 0, 0, 0, 4, 0, 0, 4, 4, 0, 4, 4, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0 },
    { 0, 0, 4, 0, 0, 4, 0, 0, 4, 0, 0, 0, 0, 4, 0, 0, 0, 0, 4, 4, 0, 4, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 4, 0, 0, 0, 0, 0, 4, 0, 0, 0, 4, 4, 4, 0, 0, 0, 4, 0, 0, 0, 0, 4, 4, 0, 4, 4, 0, 4, 0, 0, 0, 4, 0, 4, 4, 0, 0, 0 },
    { 0, 0, 4, 0, 0, 4, 0, 0, 4, 0, 0, 0, 0, 4, 0, 0, 0, 0, 4, 0, 0, 4, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 4, 0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 4, 0, 0, 0, 0, 4, 0, 0, 0, 0, 4, 0, 0, 4, 0, 0, 4, 0, 0, 0, 4, 0, 0, 4, 0, 0, 0 },
    { 0, 0, 4, 0, 0, 4, 0, 0, 4, 0, 0, 0, 0, 4, 0, 0, 0, 0, 4, 0, 0, 4, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 4, 4, 0, 4, 4, 0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 4, 0, 4, 0, 0, 4, 0, 0, 0, 0, 4, 0, 0, 4, 0, 0, 4, 0, 0, 0, 4, 0, 4, 4, 0, 0, 0 },
    { 4, 4, 4, 0, 4, 4, 0, 0, 4, 4, 0, 0, 0, 4, 4, 0, 0, 0, 4, 0, 0, 4, 0, 0, 0, 4, 4, 0, 0, 0, 0, 0, 4, 0, 0, 4, 0, 0, 4, 4, 0, 0, 0, 0, 4, 4, 0, 0, 4, 4, 0, 0, 0, 4, 4, 0, 0, 0, 4, 0, 0, 4, 0, 0, 4, 0, 0, 0, 4, 4, 0, 0, 4, 4, 0 },
}
local spiderMovePair = {
    { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1 },
    { 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0 },
    { 0, 1, 1, 1, 1, 2, 2, 2, 2, 2, 1, 1, 1, 1, 0 },
    { 1, 0, 0, 0, 1, 2, 3, 2, 3, 2, 1, 0, 0, 0, 1 },
    { 0, 1, 1, 1, 1, 2, 2, 2, 2, 2, 1, 1, 1, 1, 0 },
    { 1, 0, 0, 0, 1, 2, 2, 2, 2, 2, 1, 0, 0, 0, 1 },
    { 0, 0, 0, 1, 0, 0, 2, 0, 2, 0, 0, 1, 0, 0, 0 },
    { 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0 },
    { 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1 },
    { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
}
local spiderMoveImpair = {

    { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0 },
    { 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1 },
    { 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0 },
    { 1, 0, 0, 1, 1, 2, 2, 2, 2, 2, 1, 1, 0, 0, 1 },
    { 0, 0, 0, 0, 1, 2, 3, 2, 3, 2, 1, 0, 0, 0, 0 },
    { 0, 1, 1, 1, 1, 2, 2, 2, 2, 2, 1, 1, 1, 1, 0 },
    { 1, 0, 0, 0, 1, 2, 2, 2, 2, 2, 1, 0, 0, 0, 1 },
    { 0, 0, 0, 1, 0, 0, 2, 0, 2, 0, 0, 1, 0, 0, 0 },
    { 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0 },
    { 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0 },
    { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
}
local femelleSheep =
{

    { 0, 0, 0, 0, 0,  0,  0,  0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 0, 0, 0, 0, 0,  0,  0,  0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 0, 0, 0, 0, 0,  0,  0,  0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 0, 0, 0, 0, 0,  0,  0,  0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 0, 0, 0, 0, 0,  1,  1,  1, 1, 1, 1, 1, 0, 0, 0, 0 },
    { 0, 0, 0, 1, 1,  1,  1,  1, 1, 1, 1, 1, 1, 1, 0, 0 },
    { 0, 0, 0, 2, 2,  2,  2,  2, 1, 1, 1, 1, 1, 1, 1, 0 },
    { 0, 0, 1, 1, 31, 2,  31, 1, 1, 1, 1, 1, 1, 1, 1, 0 },
    { 0, 0, 1, 1, 2,  37, 2,  1, 1, 1, 1, 1, 1, 1, 1, 0 },
    { 0, 0, 1, 1, 1,  2,  1,  1, 1, 1, 1, 1, 1, 1, 1, 0 },
    { 0, 0, 1, 1, 1,  1,  1,  1, 1, 1, 1, 1, 1, 1, 0, 0 },
    { 0, 0, 0, 1, 1,  1,  1,  1, 1, 1, 1, 1, 1, 1, 0, 0 },
    { 0, 0, 0, 0, 4,  0,  4,  0, 0, 0, 4, 0, 4, 0, 0, 0 },
    { 0, 0, 0, 0, 0,  0,  0,  0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 0, 0, 0, 0, 0,  0,  0,  0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 0, 0, 0, 0, 0,  0,  0,  0, 0, 0, 0, 0, 0, 0, 0, 0 }
}
local maleSheep =
{

    { 0, 0, 0, 0, 0,  0,  0,  0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 0, 0, 0, 0, 0,  0,  0,  0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 0, 0, 0, 0, 0,  0,  0,  0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 0, 0, 0, 0, 0,  0,  0,  0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 0, 0, 0, 0, 0,  1,  1,  1, 1, 1, 1, 1, 0, 0, 0, 0 },
    { 0, 0, 3, 3, 3,  1,  3,  3, 3, 1, 1, 1, 1, 1, 0, 0 },
    { 0, 0, 3, 2, 3,  2,  3,  2, 3, 1, 1, 1, 1, 1, 1, 0 },
    { 0, 0, 3, 1, 31, 2,  31, 1, 3, 1, 1, 1, 1, 1, 1, 0 },
    { 0, 0, 1, 1, 2,  37, 2,  1, 1, 1, 1, 1, 1, 1, 1, 0 },
    { 0, 0, 1, 1, 1,  2,  1,  1, 1, 1, 1, 1, 1, 1, 1, 0 },
    { 0, 0, 1, 1, 1,  1,  1,  1, 1, 1, 1, 1, 1, 1, 0, 0 },
    { 0, 0, 0, 1, 1,  1,  1,  1, 1, 1, 1, 1, 1, 1, 0, 0 },
    { 0, 0, 0, 0, 4,  0,  4,  0, 0, 0, 4, 0, 4, 0, 0, 0 },
    { 0, 0, 0, 0, 0,  0,  0,  0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 0, 0, 0, 0, 0,  0,  0,  0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 0, 0, 0, 0, 0,  0,  0,  0, 0, 0, 0, 0, 0, 0, 0, 0 }
}
local youngSheep = {

    { 0, 0, 0, 0, 0,  0,  0,  0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 0, 0, 0, 0, 0,  0,  0,  0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 0, 0, 0, 0, 0,  0,  0,  0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 0, 0, 0, 0, 0,  0,  0,  0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 0, 0, 0, 0, 0,  0,  0,  0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 0, 0, 0, 0, 1,  1,  1,  1, 1, 1, 0, 0, 0, 0, 0, 0 },
    { 0, 0, 0, 2, 2,  2,  2,  2, 1, 1, 1, 0, 0, 0, 0, 0 },
    { 0, 0, 0, 1, 31, 2,  31, 1, 1, 1, 1, 0, 0, 0, 0, 0 },
    { 0, 0, 0, 1, 2,  37, 2,  1, 1, 1, 1, 1, 0, 0, 0, 0 },
    { 0, 0, 0, 1, 1,  2,  1,  1, 1, 1, 1, 1, 0, 0, 0, 0 },
    { 0, 0, 0, 0, 4,  0,  4,  0, 4, 0, 4, 0, 0, 0, 0, 0 },
    { 0, 0, 0, 0, 0,  0,  0,  0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 0, 0, 0, 0, 0,  0,  0,  0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 0, 0, 0, 0, 0,  0,  0,  0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 0, 0, 0, 0, 0,  0,  0,  0, 0, 0, 0, 0, 0, 0, 0, 0 },
    { 0, 0, 0, 0, 0,  0,  0,  0, 0, 0, 0, 0, 0, 0, 0, 0 }
}

local colors = {
    [1] = { 51, 51, 0 },
    [2] = { 64, 64, 64 },
    [3] = { 204, 0, 0 },
    [4] = { 204, 204, 0 },

}
local retroColors = {
    [1] = { 240, 237, 255 },
    [2] = { 163, 151, 216 },
    [3] = { 50, 39, 99 },
    [4] = { 20, 2, 40 },
    [5] = { 249, 230, 194 },
    [6] = { 249, 134, 92 },
    [7] = { 211, 12, 29 },
    [8] = { 130, 0, 58 },
    [9] = { 255, 235, 186 },
    [10] = { 249, 170, 72 },
    [11] = { 158, 53, 30 },
    [12] = { 91, 11, 40 },
    [13] = { 255, 249, 191 },
    [14] = { 206, 194, 57 },
    [15] = { 142, 142, 27 },
    [16] = { 46, 84, 0 },
    [17] = { 233, 255, 147 },
    [18] = { 170, 198, 57 },
    [19] = { 56, 153, 0 },
    [20] = { 0, 73, 19 },
    [21] = { 208, 249, 132 },
    [22] = { 110, 224, 69 },
    [23] = { 29, 198, 43 },
    [24] = { 5, 114, 56 },
    [25] = { 229, 255, 209 },
    [26] = { 158, 255, 158 },
    [27] = { 50, 219, 129 },
    [28] = { 7, 122, 122 },
    [29] = { 186, 255, 211 },
    [30] = { 112, 255, 228 },
    [31] = { 35, 181, 239 },
    [32] = { 5, 36, 119 },
    [33] = { 230, 201, 255 },
    [34] = { 182, 99, 249 },
    [35] = { 98, 47, 237 },
    [36] = { 33, 12, 91 },
    [37] = { 249, 199, 235 },
    [38] = { 191, 138, 234 },
    [39] = { 86, 66, 175 },
    [40] = { 39, 25, 99 }
}

local sprite = spiderSprite
local animationTimer = 0
function Draws.ultima(x, y, scale)
    -- Mouvement basé sur sin(time)
    for j = 1, #miniUltimaSprite do
        for i = 1, #miniUltimaSprite[j] do
            local val = miniUltimaSprite[j][i]
            if val ~= 0 then
                local r, g, b = convertColor(colors[val])
                love.graphics.setColor(r, g, b)
                love.graphics.rectangle("fill", x + (i - 1) * scale, y + (j - 1) * scale, scale, scale)
            end
        end
    end
end

function Draws.spider(x, y, scale)
    -- Mouvement basé sur sin(time)
    for j = 1, #sprite do
        for i = 1, #sprite[j] do
            local val = sprite[j][i]
            if val ~= 0 then
                local r, g, b = convertColor(colors[val])
                love.graphics.setColor(r, g, b)
                love.graphics.rectangle("fill", x + (i - 1) * scale, y + (j - 1) * scale, scale, scale)
            end
        end
    end
end

function Draws.sheep(x, y, scale, sheep)
    local grid = nil
    local sex = sheep.reproduction.sex
    if sheep.lifeCycle.ageMonths >= sheep.reproduction.adultAgeMonths then
        if sex == "Female" then
            grid = femelleSheep
        else
            grid = maleSheep
        end
    else
        grid = youngSheep
    end
    local sheepColors={1,33,9,11,12,3,4}
    -- Mouvement basé sur sin(time)
    for j = 1, #grid do
        for i = 1, #grid[j] do
            local colorIndex = grid[j][i]
                        -- Interpretation of grid values: 
            -- 0 : empty (not drawn) 
            -- 1 : wool (dynamic according to woolColor) 
            -- Other: direct value of a retroColors index
            if colorIndex ~= 0 then
                if colorIndex ==1 then
                    --sheep.woolColor is between 1 & 16
                    -- so we project this to an index [1,7] in order to find the drawing color
                    local index=(sheep.woolColor%7)+1
                    colorIndex=sheepColors[index]
                end
                local r, g, b = convertColor(retroColors[colorIndex])
                love.graphics.setColor(r, g, b)
                love.graphics.rectangle("fill", x + (i - 1) * scale, y + (j - 1) * scale, scale, scale)
            end
        end
    end
end

function Draws.getRetroColor(colorIndex)
    if retroColors[colorIndex] then
        return retroColors[colorIndex]
    end
end

function Draws.update(dt)
    time = time + dt
    animationTimer = animationTimer + dt
    if animationTimer > 0.25 and animationTimer < 0.5 then
        sprite = spiderMoveImpair
    elseif animationTimer > 0.75 and animationTimer < 1 then
        sprite = spiderMovePair
    else
        sprite = spiderSprite
    end
    if animationTimer >= 1 then
        animationTimer = 0
    end
end

return Draws
